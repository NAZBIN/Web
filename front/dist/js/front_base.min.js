function FrontBase(){}function Auth(){var t=this;t.maskWrapper=$(".mask-wrapper"),t.scrollWrapper=$(".scroll-wrapper"),t.smsCaptcha=$(".sms-captcha-btn")}FrontBase.prototype.listenAuthBoxHover=function(){var t=$(".auth-box"),n=$(".user-more-box");t.hover(function(){n.show()},function(){n.hide()})},FrontBase.prototype.handleNavStatus=function(){var t=window.location.href,n=window.location.protocol+"//"+window.location.host,a=t.replace(n,"");console.log(a),$(".nav li").each(function(t,n){var e=$(n);if(e.children("a").attr("href")===a)return e.addClass("active").siblings().removeClass("active"),!1})},FrontBase.prototype.run=function(){this.listenAuthBoxHover(),this.handleNavStatus()},Auth.prototype.showEvent=function(){this.maskWrapper.show()},Auth.prototype.hideEvent=function(){this.maskWrapper.hide()},Auth.prototype.listenShowHideEvent=function(){var n=this,t=$(".signin-btn"),e=$(".signup-btn"),a=$(".close-btn");t.click(function(){n.showEvent()}),e.click(function(){n.showEvent(),n.scrollWrapper.css({left:"-400px"})}),a.click(function(){var t=n.scrollWrapper.css("left");console.log(t),t=parseInt(t),n.hideEvent(),t<0?n.scrollWrapper.animate({left:"0"}):n.scrollWrapper.animate({left:"-400px"})})},Auth.prototype.listenSwitchEvent=function(){var n=this;$(".switch").click(function(){var t=n.scrollWrapper.css("left");(t=parseInt(t))<0?n.scrollWrapper.animate({left:"0"}):n.scrollWrapper.animate({left:"-400px"})})},Auth.prototype.listenImgCaptchaEvent=function(){var t=$(".img-captcha");t.click(function(){t.attr("src","/account/img_captcha/?random="+Math.random())})},Auth.prototype.listenSigninEvent=function(){var s=this,t=$(".signin-group"),o=t.find("input[name='telephone']"),i=t.find("input[name='password']"),r=t.find("input[name='remember']");t.find(".submit-btn").click(function(t){t.preventDefault();var n=o.val(),e=i.val(),a=r.prop("checked");xfzajax.post({url:"/account/login/",data:{telephone:n,password:e,remember:a?1:0},success:function(t){if(200==t.code)s.hideEvent(),window.location.reload();else{var n=t.message;if("String"==typeof n||n.constructor==String)window.messageBox.show(n);else for(var e in n){var a=n[e][0];window.messageBox.show(a)}}},fail:function(t){console.log(t)}})})},Auth.prototype.listenSignupEvent=function(){var f=this,v=$(".signup-group");v.find(".submit-btn").click(function(t){t.preventDefault();var n=v.find("input[name='telephone']"),e=v.find("input[name='username']"),a=v.find("input[name='img_captcha']"),s=v.find("input[name='password1']"),o=v.find("input[name='password2']"),i=v.find("input[name='sms_captcha']"),r=n.val(),c=e.val(),p=a.val(),l=s.val(),u=o.val(),h=i.val();xfzajax.post({url:"/account/register/",data:{telephone:r,username:c,img_captcha:p,password1:l,password2:u,sms_captcha:h},success:function(t){if(200==t.code)f.hideEvent(),window.location.reload();else{var n=t.message;if("String"==typeof n||n.constructor==String)window.messageBox.show(n);else for(var e in n){var a=n[e][0];window.messageBox.show(a)}}},fail:function(t){console.log(t)}})})},Auth.prototype.smsSuccessEvent=function(){var t=this;messageBox.showSuccess("短信验证码发送成功！"),t.smsCaptcha.addClass("disabled");var n=60;t.smsCaptcha.unbind("click");var e=setInterval(function(){t.smsCaptcha.text(n+"s"),(n-=1)<=0&&(clearInterval(e),t.smsCaptcha.removeClass("disabled"),t.smsCaptcha.text("发送验证码"),t.listenSmsCaptchaEvent())},1e3)},Auth.prototype.listenSmsCaptchaEvent=function(){var n=this,t=$(".sms-captcha-btn"),e=$(".signup-group input[name='telephone']");t.click(function(){var t=e.val();t||messageBox.showInfo("请输入手机号码"),xfzajax.get({url:"/account/sms_captcha/",data:{telephone:t},success:function(t){200==t.code&&n.smsSuccessEvent()},fail:function(t){console.log(t)}})})},Auth.prototype.run=function(){var t=this;t.listenShowHideEvent(),t.listenSwitchEvent(),t.listenSigninEvent(),t.listenSignupEvent(),t.listenImgCaptchaEvent(),t.listenSmsCaptchaEvent()},$(function(){(new Auth).run()}),$(function(){(new FrontBase).run()}),$(function(){window.template&&(template.defaults.imports.timeSince=function(t){var n=new Date(t),e=n.getTime(),a=((new Date).getTime()-e)/1e3;return a<60?"刚刚":60<=a&&a<3600?(minutes=parseInt(a/60),minutes+"分钟前"):3600<=a&&a<86400?(hours=parseInt(a/3600),hours+"小时前"):86400<=a&&a<2592e3?(days=parseInt(a/86400),days+"天前"):n.getFullYear()+"/"+n.getMonth()+"/"+n.getDay()+" "+n.getHours()+":"+n.getMinutes()})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZyb250X2Jhc2UuanMiXSwibmFtZXMiOlsiRnJvbnRCYXNlIiwiQXV0aCIsInNlbGYiLCJ0aGlzIiwibWFza1dyYXBwZXIiLCIkIiwic2Nyb2xsV3JhcHBlciIsInNtc0NhcHRjaGEiLCJwcm90b3R5cGUiLCJsaXN0ZW5BdXRoQm94SG92ZXIiLCJhdXRoQm94IiwidXNlck1vcmVCb3giLCJob3ZlciIsInNob3ciLCJoaWRlIiwiaGFuZGxlTmF2U3RhdHVzIiwidXJsIiwid2luZG93IiwibG9jYXRpb24iLCJocmVmIiwiZG9tYWluIiwicHJvdG9jb2wiLCJob3N0IiwicGF0aCIsInJlcGxhY2UiLCJjb25zb2xlIiwibG9nIiwiZWFjaCIsImluZGV4IiwiZWxlbWVudCIsImxpIiwiY2hpbGRyZW4iLCJhdHRyIiwiYWRkQ2xhc3MiLCJzaWJsaW5ncyIsInJlbW92ZUNsYXNzIiwicnVuIiwic2hvd0V2ZW50IiwiaGlkZUV2ZW50IiwibGlzdGVuU2hvd0hpZGVFdmVudCIsInNpZ25pbiIsInNpZ251cCIsImNsb3NlYnRuIiwiY2xpY2siLCJjc3MiLCJsZWZ0IiwiY3VycmVudExlZnQiLCJwYXJzZUludCIsImFuaW1hdGUiLCJsaXN0ZW5Td2l0Y2hFdmVudCIsImxpc3RlbkltZ0NhcHRjaGFFdmVudCIsImltZ0NhcHRjaGEiLCJNYXRoIiwicmFuZG9tIiwibGlzdGVuU2lnbmluRXZlbnQiLCJzaWduaW5Hcm91cCIsInRlbGVwaG9uZUlucHV0IiwiZmluZCIsInBhc3N3b3JkSW5wdXQiLCJyZW1lbWJlcklucHV0IiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsInRlbGVwaG9uZSIsInZhbCIsInBhc3N3b3JkIiwicmVtZW1iZXIiLCJwcm9wIiwieGZ6YWpheCIsInBvc3QiLCJkYXRhIiwic3VjY2VzcyIsInJlc3VsdCIsInJlbG9hZCIsIm1lc3NhZ2VPYmplY3QiLCJjb25zdHJ1Y3RvciIsIlN0cmluZyIsIm1lc3NhZ2VCb3giLCJrZXkiLCJtZXNzYWdlIiwiZmFpbCIsImVycm9yIiwibGlzdGVuU2lnbnVwRXZlbnQiLCJzaWdudXBHcm91cCIsInVzZXJuYW1lSW5wdXQiLCJpbWdDYXB0Y2hhSW5wdXQiLCJwYXNzd29yZDFJbnB1dCIsInBhc3N3b3JkMklucHV0Iiwic21zQ2FwdGNoYUlucHV0IiwidXNlcm5hbWUiLCJpbWdfY2FwdGNoYSIsInBhc3N3b3JkMSIsInBhc3N3b3JkMiIsInNtc19jYXB0Y2hhIiwic21zU3VjY2Vzc0V2ZW50Iiwic2hvd1N1Y2Nlc3MiLCJjb3VudCIsInVuYmluZCIsInRpbWVyIiwic2V0SW50ZXJ2YWwiLCJ0ZXh0IiwiY2xlYXJJbnRlcnZhbCIsImxpc3RlblNtc0NhcHRjaGFFdmVudCIsInNob3dJbmZvIiwiZ2V0IiwidGVtcGxhdGUiLCJkZWZhdWx0cyIsImltcG9ydHMiLCJ0aW1lU2luY2UiLCJkYXRlVmFsdWUiLCJkYXRlIiwiRGF0ZSIsImRhdGV0cyIsImdldFRpbWUiLCJ0aW1lc3RhbXAiLCJtaW51dGVzIiwiaG91cnMiLCJkYXlzIiwiZ2V0RnVsbFllYXIiLCJnZXRNb250aCIsImdldERheSIsImdldEhvdXJzIiwiZ2V0TWludXRlcyJdLCJtYXBwaW5ncyI6IkFBQ0EsU0FBU0EsYUE2Q1QsU0FBU0MsT0FDTCxJQUFJQyxFQUFPQyxLQUNYRCxFQUFLRSxZQUFjQyxFQUFFLGlCQUNyQkgsRUFBS0ksY0FBZ0JELEVBQUUsbUJBQ3ZCSCxFQUFLSyxXQUFhRixFQUFFLG9CQTlDeEJMLFVBQVVRLFVBQVVDLG1CQUFxQixXQUVyQyxJQUFJQyxFQUFVTCxFQUFFLGFBQ1pNLEVBQWNOLEVBQUUsa0JBQ3BCSyxFQUFRRSxNQUFNLFdBQ1ZELEVBQVlFLFFBQ2QsV0FDRUYsRUFBWUcsVUFJcEJkLFVBQVVRLFVBQVVPLGdCQUFrQixXQUNsQyxJQUFJQyxFQUFNQyxPQUFPQyxTQUFTQyxLQUd0QkMsRUFGV0gsT0FBT0MsU0FBU0csU0FFVCxLQURYSixPQUFPQyxTQUFTSSxLQUV2QkMsRUFBT1AsRUFBSVEsUUFBUUosRUFBTyxJQUM5QkssUUFB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LE9BQ3JCRyxLQUFPLE1BR0hQLEVBQUtRLGNBS0YsSUFKRlIsRUFBS1MsV0FJVyxJQUhsQlQsRUFBS1UsU0FHeUIsSUFGN0JWLEVBQUtXLFdBRXFDLElBRHhDWCxFQUFLWSIsImZpbGUiOiJmcm9udF9iYXNlLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8v55m75b2V5LmL5ZCO6byg5qCH56e75Yqo5ZyoYXV0aC1ib3jkuIrvvIzmjqfliLbliJfooajnmoTnjrDlrp7kuI7pmpDol49cclxuZnVuY3Rpb24gRnJvbnRCYXNlKCkge1xyXG5cclxufVxyXG5Gcm9udEJhc2UucHJvdG90eXBlLmxpc3RlbkF1dGhCb3hIb3ZlciA9IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICB2YXIgYXV0aEJveCA9ICQoXCIuYXV0aC1ib3hcIik7XHJcbiAgICB2YXIgdXNlck1vcmVCb3ggPSAkKFwiLnVzZXItbW9yZS1ib3hcIik7XHJcbiAgICBhdXRoQm94LmhvdmVyKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB1c2VyTW9yZUJveC5zaG93KCk7XHJcbiAgICB9LGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB1c2VyTW9yZUJveC5oaWRlKCk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbkZyb250QmFzZS5wcm90b3R5cGUuaGFuZGxlTmF2U3RhdHVzID0gZnVuY3Rpb24oKXtcclxuICAgIHZhciB1cmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZjsgLy/mi7/liLB1cmwgICAgaHR0cDovLzEyNy4wLjAuMTo4MDAwL3BheWluZm8vXHJcbiAgICB2YXIgcHJvdG9jb2wgPSB3aW5kb3cubG9jYXRpb24ucHJvdG9jb2w7XHJcbiAgICB2YXIgaG9zdCA9IHdpbmRvdy5sb2NhdGlvbi5ob3N0O1xyXG4gICAgdmFyIGRvbWFpbiA9IHByb3RvY29sKycvLycraG9zdDtcclxuICAgIHZhciBwYXRoID0gdXJsLnJlcGxhY2UoZG9tYWluLCcnKTtcclxuICAgIGNvbnNvbGUubG9nKHBhdGgpO1xyXG4gICAgLy/miormiYDmnInnmoTlr7zoiKrmnaF1cmzmi7/lh7rmnaXljLnphY3vvIzlpoLmnpzkuIDmoLfnu5nlroPliqDkuIphY3RpdmVcclxuICAgIHZhciBuYXZMaXMgPSAkKFwiLm5hdiBsaVwiKTtcclxuICAgIC8v6YGN5Y6G5b6q546vanF1ZXJ55a+56LGhXHJcbiAgICBuYXZMaXMuZWFjaChmdW5jdGlvbiAoaW5kZXgsZWxlbWVudCkge1xyXG4gICAgICAgIC8vZWxlbWVudOaYr2pz5a+56LGh77yMXHJcbiAgICAgICAgLy/lhYjovazmjaLmiJBqcXVlcnnlr7nosaFcclxuICAgICAgICB2YXIgbGkgPSAkKGVsZW1lbnQpO1xyXG4gICAgICAgIHZhciBhVGFnID0gbGkuY2hpbGRyZW4oXCJhXCIpO1xyXG4gICAgICAgIHZhciBocmVmID0gYVRhZy5hdHRyKFwiaHJlZlwiKTtcclxuICAgICAgICBpZihocmVmID09PSBwYXRoKXtcclxuICAgICAgICAgICAgbGkuYWRkQ2xhc3MoXCJhY3RpdmVcIikuc2libGluZ3MoKS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlOyAvL+S4reatouaJp+ihjFxyXG4gICAgICAgICAgICAvL+a4hemZpOWFtuWug+eahGFjdGl2ZVxyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbn07XHJcblxyXG5Gcm9udEJhc2UucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYubGlzdGVuQXV0aEJveEhvdmVyKCk7XHJcbiAgICBzZWxmLmhhbmRsZU5hdlN0YXR1cygpO1xyXG59O1xyXG5cclxuLy/mjqfliLbnmbvlvZXnqpflj6PnmoTmmL7npLrkuI7pmpDol48g55m75b2V5ZKM5rOo5YaMXHJcbmZ1bmN0aW9uIEF1dGgoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLm1hc2tXcmFwcGVyID0gJChcIi5tYXNrLXdyYXBwZXJcIik7XHJcbiAgICBzZWxmLnNjcm9sbFdyYXBwZXIgPSAkKFwiLnNjcm9sbC13cmFwcGVyXCIpO1xyXG4gICAgc2VsZi5zbXNDYXB0Y2hhID0gJChcIi5zbXMtY2FwdGNoYS1idG5cIik7XHJcblxyXG5cclxufVxyXG5cclxuQXV0aC5wcm90b3R5cGUuc2hvd0V2ZW50ID0gZnVuY3Rpb24oKXtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYubWFza1dyYXBwZXIuc2hvdygpO1xyXG59O1xyXG5BdXRoLnByb3RvdHlwZS5oaWRlRXZlbnQgPSBmdW5jdGlvbigpe1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgc2VsZi5tYXNrV3JhcHBlci5oaWRlKCk7XHJcbn07XHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNob3dIaWRlRXZlbnQgPSBmdW5jdGlvbigpe1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIHNpZ25pbiA9ICQoXCIuc2lnbmluLWJ0blwiKTtcclxuICAgIHZhciBzaWdudXAgPSAkKFwiLnNpZ251cC1idG5cIik7XHJcbiAgICB2YXIgY2xvc2VidG4gPSAkKFwiLmNsb3NlLWJ0blwiKTtcclxuICAgIHNpZ25pbi5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VsZi5zaG93RXZlbnQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHNpZ251cC5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VsZi5zaG93RXZlbnQoKTtcclxuICAgICAgICBzZWxmLnNjcm9sbFdyYXBwZXIuY3NzKHtcImxlZnRcIjonLTQwMHB4J30pO1xyXG5cclxuICAgIH0pO1xyXG4gICAgY2xvc2VidG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBjdXJyZW50TGVmdCA9IHNlbGYuc2Nyb2xsV3JhcHBlci5jc3MoXCJsZWZ0XCIpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGN1cnJlbnRMZWZ0KTtcclxuICAgICAgICBjdXJyZW50TGVmdCA9IHBhcnNlSW50KGN1cnJlbnRMZWZ0KTsgLy/ovazmjaLmiJDmlbTlvaJcclxuICAgICAgICBzZWxmLmhpZGVFdmVudCgpO1xyXG4gICAgICAgIGlmKGN1cnJlbnRMZWZ0IDwgMCl7XHJcbiAgICAgICAgICAgIHNlbGYuc2Nyb2xsV3JhcHBlci5hbmltYXRlKHtcImxlZnRcIjonMCd9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHNlbGYuc2Nyb2xsV3JhcHBlci5hbmltYXRlKHtcImxlZnRcIjonLTQwMHB4J30pO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUubGlzdGVuU3dpdGNoRXZlbnQgPSBmdW5jdGlvbigpe1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG5cclxuICAgICQoXCIuc3dpdGNoXCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgY3VycmVudExlZnQgPSBzZWxmLnNjcm9sbFdyYXBwZXIuY3NzKFwibGVmdFwiKTtcclxuXHJcbiAgICAgICAgY3VycmVudExlZnQgPSBwYXJzZUludChjdXJyZW50TGVmdCk7IC8v6L2s5o2i5oiQ5pW05b2iXHJcbiAgICAgICAgaWYoY3VycmVudExlZnQgPCAwKXtcclxuICAgICAgICAgICAgc2VsZi5zY3JvbGxXcmFwcGVyLmFuaW1hdGUoe1wibGVmdFwiOicwJ30pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgc2VsZi5zY3JvbGxXcmFwcGVyLmFuaW1hdGUoe1wibGVmdFwiOictNDAwcHgnfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5JbWdDYXB0Y2hhRXZlbnQgPSBmdW5jdGlvbigpe1xyXG4gICAgdmFyIGltZ0NhcHRjaGEgPSAkKFwiLmltZy1jYXB0Y2hhXCIpO1xyXG4gICAgaW1nQ2FwdGNoYS5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy/mm7TmlLnlm77niYfvvIzorqnnlKjmiLfngrnlh7vnmoTml7blgJnph43mlrDliqDovb3kuIDkuIvlm77niYfnmoR1cmzljbPlj68gdXJs5Zu65a6a5LiN5Y+Y5Y+v5Lul5Zyo5a6D5ZCO6Z2i5Yqg5Y+C5pWwXHJcbiAgICAgICAgaW1nQ2FwdGNoYS5hdHRyKFwic3JjXCIsXCIvYWNjb3VudC9pbWdfY2FwdGNoYS9cIitcIj9yYW5kb209XCIrTWF0aC5yYW5kb20oKSlcclxuICAgIH0pXHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5TaWduaW5FdmVudCA9IGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgc2lnbmluR3JvdXAgPSAkKCcuc2lnbmluLWdyb3VwJyk7XHJcbiAgICB2YXIgdGVsZXBob25lSW5wdXQgPSBzaWduaW5Hcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ndGVsZXBob25lJ11cIik7ICAvL+aLv+WIsOeUteivneWPt+eggeeahOi+k+WFpeahhlxyXG4gICAgdmFyIHBhc3N3b3JkSW5wdXQgPSBzaWduaW5Hcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ncGFzc3dvcmQnXVwiKTtcclxuICAgIHZhciByZW1lbWJlcklucHV0ID0gc2lnbmluR3JvdXAuZmluZChcImlucHV0W25hbWU9J3JlbWVtYmVyJ11cIik7XHJcblxyXG4gICAgdmFyIHN1Ym1pdEJ0biA9IHNpZ25pbkdyb3VwLmZpbmQoXCIuc3VibWl0LWJ0blwiKTtcclxuICAgIHN1Ym1pdEJ0bi5jbGljayhmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHZhciB0ZWxlcGhvbmUgPSB0ZWxlcGhvbmVJbnB1dC52YWwoKTtcclxuICAgICAgICB2YXIgcGFzc3dvcmQgPSBwYXNzd29yZElucHV0LnZhbCgpO1xyXG4gICAgICAgIHZhciByZW1lbWJlciA9IHJlbWVtYmVySW5wdXQucHJvcChcImNoZWNrZWRcIik7XHJcbiAgICAgICAgeGZ6YWpheC5wb3N0KHtcclxuICAgICAgICAgICAgJ3VybCc6Jy9hY2NvdW50L2xvZ2luLycsXHJcbiAgICAgICAgICAgICdkYXRhJzp7XHJcbiAgICAgICAgICAgICAgICAndGVsZXBob25lJzp0ZWxlcGhvbmUsXHJcbiAgICAgICAgICAgICAgICAncGFzc3dvcmQnOnBhc3N3b3JkLFxyXG4gICAgICAgICAgICAgICAgJ3JlbWVtYmVyJzpyZW1lbWJlcj8xOjBcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOmZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGlmKHJlc3VsdFsnY29kZSddID09IDIwMCl7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5oaWRlRXZlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKClcclxuICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlT2JqZWN0ID0gcmVzdWx0WydtZXNzYWdlJ107XHJcbiAgICAgICAgICAgICAgICAgICAgaWYodHlwZW9mIG1lc3NhZ2VPYmplY3QgPT0gJ1N0cmluZycgfHwgbWVzc2FnZU9iamVjdC5jb25zdHJ1Y3RvciA9PSBTdHJpbmcpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93KG1lc3NhZ2VPYmplY3QpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGtleSBpbiBtZXNzYWdlT2JqZWN0KXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlcyA9IG1lc3NhZ2VPYmplY3Rba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gbWVzc2FnZXNbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93KG1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnZmFpbCc6ZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XHJcblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH0pXHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5TaWdudXBFdmVudCA9IGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgc2lnbnVwR3JvdXAgPSAkKFwiLnNpZ251cC1ncm91cFwiKTtcclxuICAgIHZhciBzdWJtaXRCdG4gPSBzaWdudXBHcm91cC5maW5kKFwiLnN1Ym1pdC1idG5cIik7XHJcbiAgICBzdWJtaXRCdG4uY2xpY2soZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB2YXIgdGVsZXBob25lSW5wdXQgPSBzaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ndGVsZXBob25lJ11cIik7XHJcbiAgICAgICAgdmFyIHVzZXJuYW1lSW5wdXQgPSBzaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ndXNlcm5hbWUnXVwiKTtcclxuICAgICAgICB2YXIgaW1nQ2FwdGNoYUlucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J2ltZ19jYXB0Y2hhJ11cIik7XHJcbiAgICAgICAgdmFyIHBhc3N3b3JkMUlucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3Bhc3N3b3JkMSddXCIpO1xyXG4gICAgICAgIHZhciBwYXNzd29yZDJJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdwYXNzd29yZDInXVwiKTtcclxuICAgICAgICB2YXIgc21zQ2FwdGNoYUlucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3Ntc19jYXB0Y2hhJ11cIik7XHJcblxyXG4gICAgICAgIHZhciB0ZWxlcGhvbmUgPSB0ZWxlcGhvbmVJbnB1dC52YWwoKTtcclxuICAgICAgICB2YXIgdXNlcm5hbWUgPSB1c2VybmFtZUlucHV0LnZhbCgpO1xyXG4gICAgICAgIHZhciBpbWdfY2FwdGNoYSA9IGltZ0NhcHRjaGFJbnB1dC52YWwoKTtcclxuICAgICAgICB2YXIgcGFzc3dvcmQxID0gcGFzc3dvcmQxSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHBhc3N3b3JkMiA9IHBhc3N3b3JkMklucHV0LnZhbCgpO1xyXG4gICAgICAgIHZhciBzbXNfY2FwdGNoYSA9IHNtc0NhcHRjaGFJbnB1dC52YWwoKTtcclxuXHJcbiAgICAgICAgeGZ6YWpheC5wb3N0KHtcclxuICAgICAgICAgICAgJ3VybCc6Jy9hY2NvdW50L3JlZ2lzdGVyLycsXHJcbiAgICAgICAgICAgICdkYXRhJzp7XHJcbiAgICAgICAgICAgICAgICAndGVsZXBob25lJzogdGVsZXBob25lLFxyXG4gICAgICAgICAgICAgICAgJ3VzZXJuYW1lJzogdXNlcm5hbWUsXHJcbiAgICAgICAgICAgICAgICAnaW1nX2NhcHRjaGEnOiBpbWdfY2FwdGNoYSxcclxuICAgICAgICAgICAgICAgICdwYXNzd29yZDEnOiBwYXNzd29yZDEsXHJcbiAgICAgICAgICAgICAgICAncGFzc3dvcmQyJzogcGFzc3dvcmQyLFxyXG4gICAgICAgICAgICAgICAgJ3Ntc19jYXB0Y2hhJzogc21zX2NhcHRjaGFcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOmZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGlmKHJlc3VsdFsnY29kZSddID09IDIwMCl7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5oaWRlRXZlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZU9iamVjdCA9IHJlc3VsdFsnbWVzc2FnZSddO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHR5cGVvZiBtZXNzYWdlT2JqZWN0ID09ICdTdHJpbmcnIHx8IG1lc3NhZ2VPYmplY3QuY29uc3RydWN0b3IgPT0gU3RyaW5nKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvdyhtZXNzYWdlT2JqZWN0KTtcclxuICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBrZXkgaW4gbWVzc2FnZU9iamVjdCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZXMgPSBtZXNzYWdlT2JqZWN0W2tleV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZSA9IG1lc3NhZ2VzWzBdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93KG1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnZmFpbCc6ZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XHJcblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH0pXHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5zbXNTdWNjZXNzRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcblxyXG4gICAgbWVzc2FnZUJveC5zaG93U3VjY2Vzcygn55+t5L+h6aqM6K+B56CB5Y+R6YCB5oiQ5Yqf77yBJyk7XHJcbiAgICBzZWxmLnNtc0NhcHRjaGEuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XHJcbiAgICB2YXIgY291bnQgPSA2MDtcclxuICAgIHNlbGYuc21zQ2FwdGNoYS51bmJpbmQoJ2NsaWNrJyk7XHJcbiAgICB2YXIgdGltZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VsZi5zbXNDYXB0Y2hhLnRleHQoY291bnQrJ3MnKTtcclxuICAgICAgICBjb3VudCAtPSAxO1xyXG4gICAgICAgIGlmKGNvdW50IDw9IDApe1xyXG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRpbWVyKTtcclxuICAgICAgICAgICAgc2VsZi5zbXNDYXB0Y2hhLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xyXG4gICAgICAgICAgICBzZWxmLnNtc0NhcHRjaGEudGV4dCgn5Y+R6YCB6aqM6K+B56CBJyk7XHJcbiAgICAgICAgICAgIHNlbGYubGlzdGVuU21zQ2FwdGNoYUV2ZW50KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSwxMDAwKTtcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNtc0NhcHRjaGFFdmVudCA9IGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgc21zQ2FwdGNoYSA9ICQoXCIuc21zLWNhcHRjaGEtYnRuXCIpO1xyXG4gICAgdmFyIHRlbGVwaG9uZUlucHV0ID0gJChcIi5zaWdudXAtZ3JvdXAgaW5wdXRbbmFtZT0ndGVsZXBob25lJ11cIik7XHJcbiAgICBzbXNDYXB0Y2hhLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdGVsZXBob25lID0gdGVsZXBob25lSW5wdXQudmFsKCk7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2codGVsZXBob25lKTtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhcIui1sOWIsOesrOS4gOatpVwiKTtcclxuICAgICAgICBpZighdGVsZXBob25lKXtcclxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCLotbDliLDnrKzkuozmraVcIik7XHJcbiAgICAgICAgICAgIG1lc3NhZ2VCb3guc2hvd0luZm8oJ+ivt+i+k+WFpeaJi+acuuWPt+eggScpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhcIui1sOWIsOesrOS4ieatpVwiKTtcclxuICAgICAgICB4ZnphamF4LmdldCh7ICAgLy/ojrflj5bnn63kv6Hpqozor4HnoIHotbBnZXTor7fmsYJcclxuICAgICAgICAgICAgJ3VybCc6Jy9hY2NvdW50L3Ntc19jYXB0Y2hhLycsXHJcbiAgICAgICAgICAgICdkYXRhJzp7XHJcbiAgICAgICAgICAgICAgICAndGVsZXBob25lJzp0ZWxlcGhvbmVcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOmZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGlmKHJlc3VsdFsnY29kZSddID09IDIwMCl7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zbXNTdWNjZXNzRXZlbnQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ2ZhaWwnOmZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7IC8v5omn6KGMYWpheOivt+axguiOt+WPlumqjOivgeeggVxyXG4gICAgfSk7XHJcbn07XHJcblxyXG5cclxuQXV0aC5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgc2VsZi5saXN0ZW5TaG93SGlkZUV2ZW50KCk7XHJcbiAgICBzZWxmLmxpc3RlblN3aXRjaEV2ZW50KCk7XHJcbiAgICBzZWxmLmxpc3RlblNpZ25pbkV2ZW50KCk7XHJcbiAgICBzZWxmLmxpc3RlblNpZ251cEV2ZW50KCk7XHJcbiAgICBzZWxmLmxpc3RlbkltZ0NhcHRjaGFFdmVudCgpO1xyXG4gICAgc2VsZi5saXN0ZW5TbXNDYXB0Y2hhRXZlbnQoKTtcclxufTtcclxuXHJcbiQoZnVuY3Rpb24gKCkge1xyXG4gICB2YXIgYXV0aCA9IG5ldyBBdXRoKCk7XHJcbiAgIGF1dGgucnVuKCk7XHJcbn0pO1xyXG5cclxuJChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgZnJvbnRCYXNlID0gbmV3IEZyb250QmFzZSgpO1xyXG4gICAgZnJvbnRCYXNlLnJ1bigpO1xyXG59KTtcclxuXHJcbiQoZnVuY3Rpb24gKCkge1xyXG4gICAgaWYod2luZG93LnRlbXBsYXRlKXtcclxuICAgICAgICB0ZW1wbGF0ZS5kZWZhdWx0cy5pbXBvcnRzLnRpbWVTaW5jZSA9IGZ1bmN0aW9uIChkYXRlVmFsdWUpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZShkYXRlVmFsdWUpO1xyXG4gICAgICAgICAgICB2YXIgZGF0ZXRzID0gZGF0ZS5nZXRUaW1lKCk7IC8v5b6X5Yiw55qE5q+r56eSXHJcbiAgICAgICAgICAgIHZhciBub3d0cyA9IChuZXcgRGF0ZSgpKS5nZXRUaW1lKCk7IC8v5b6X5Yiw55qE5piv5b2T5YmN55qE5pe26Ze05oizXHJcbiAgICAgICAgICAgIHZhciB0aW1lc3RhbXAgPSAobm93dHMgLSBkYXRldHMpIC8gMTAwMDsgICAvL+W+l+WIsOeahOaYr+enklxyXG4gICAgICAgICAgICBpZiAodGltZXN0YW1wIDwgNjApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAn5Yia5YiaJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICh0aW1lc3RhbXAgPj0gNjAgJiYgdGltZXN0YW1wIDwgNjAgKiA2MCkge1xyXG4gICAgICAgICAgICAgICAgbWludXRlcyA9IHBhcnNlSW50KHRpbWVzdGFtcCAvIDYwKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBtaW51dGVzICsgJ+WIhumSn+WJjSc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAodGltZXN0YW1wID49IDYwICogNjAgJiYgdGltZXN0YW1wIDwgNjAgKiA2MCAqIDI0KSB7XHJcbiAgICAgICAgICAgICAgICBob3VycyA9IHBhcnNlSW50KHRpbWVzdGFtcCAvICg2MCAqIDYwKSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaG91cnMgKyAn5bCP5pe25YmNJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICh0aW1lc3RhbXAgPj0gNjAgKiA2MCAqIDI0ICYmIHRpbWVzdGFtcCA8IDYwICogNjAgKiAyNCAqIDMwKSB7XHJcbiAgICAgICAgICAgICAgICBkYXlzID0gcGFyc2VJbnQodGltZXN0YW1wIC8gKDYwICogNjAgKiAyNCkpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRheXMgKyAn5aSp5YmNJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdmFyIHllYXIgPSBkYXRlLmdldEZ1bGxZZWFyKCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgbW9udGggPSBkYXRlLmdldE1vbnRoKCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGF5ID0gZGF0ZS5nZXREYXkoKTtcclxuICAgICAgICAgICAgICAgIHZhciBob3VyID0gZGF0ZS5nZXRIb3VycygpO1xyXG4gICAgICAgICAgICAgICAgdmFyIG1pbnV0ZSA9IGRhdGUuZ2V0TWludXRlcygpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHllYXIgKyAnLycgKyBtb250aCArICcvJyArIGRheSArIFwiIFwiICsgaG91ciArICc6JyArIG1pbnV0ZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KTsiXX0=
